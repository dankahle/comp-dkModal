!function(){"use strict";function e(e){return $.each(e,function(t,o){"string"==typeof e[t]&&(e[t]=e[t].trim())}),["offsetTop","offsetLeft","width","height"].forEach(function(t,o){("number"==typeof e[t]||"string"==typeof e[t]&&/^\d+$/.test(e[t]))&&(e[t]=e[t]+"px")}),""===e.targetOffset||void 0===e.targetOffset?e.targetOffset=0:"string"==typeof e.targetOffset&&(e.targetOffset=parseFloat(e.targetOffset)),e.test&&"mobile"==e.test.mode?t=!0:e.test&&"desktop"==e.test.mode&&(t=!1),e}var t=(console.log.bind(console),-1!=window.navigator.userAgent.indexOf("Mobi"));if(!$)throw new Error("dkModal depends on jquery");if(!angular)throw new Error("dkModal depends on angular");var o=angular.module("dkModal",["ngAnimate","ngTouch","ngSanitize"]);o.provider("dkModal",function(){var o=767,n=27,r=2,i="96%",a={},l={selector:void 0,template:void 0,templateUrl:void 0,key:!0,click:!0,offsetTop:void 0,offsetLeft:void 0,target:void 0,targetSide:"right",targetVert:"middle",targetOffset:20,width:void 0,height:void 0,backdropColor:void 0,cancelEventName:"modalCancel",okEventName:"modalOk",defaultClose:!0,defaultHeader:void 0,defaultBody:"",defaultFooter:void 0,test:{mobileView:!1}};return a.setDefaults=function(t){angular.extend(l,e(t))},a.$get=["$http","$templateCache","$compile","$animate","$rootScope","$timeout","$q",function(a,d,s,c,f,p,h){return function(g){function u(e){return f.$apply(function(){U.hide("ok")}),!1}function w(e){return f.$apply(function(){U.hide("cancel")}),!1}function m(e){return e.which==n&&f.$apply(function(){U.hide("cancel")}),!1}function v(){return f.$apply(function(){U.hide("cancel")}),!1}function k(){var e,n,a,l;if(a=t&&window.innerWidth<=o,l=b.find("input, select, textarea").length>0,b.find(".exit-ok").click(u),b.find(".exit-cancel").click(w),b.addClass("dk-modal"),b.attr("tabindex","-1"),E.key&&b.on("keyup",m),E.width){var d=-1!=E.width.indexOf("%")?window.innerWidth*parseInt(E.width)/100:parseInt(E.width);d=d>window.innerWidth?window.innerWidth+"px":E.width,b.css("width",d)}else b.css("width","");var s=window.innerWidth*(r/100);if(E.height){var f=-1!=E.height.indexOf("%")?window.innerHeight*parseInt(E.height)/100:parseInt(E.height);f=a&&f+s>window.innerHeight?window.innerHeight-s+"px":f>window.innerHeight?window.innerHeight+"px":E.height,b.css("height",f)}else b.css("height","");b.css("left","-9999px"),b.show(),O||$(document.body).prepend(b);var p=b.outerWidth(),h=b.outerHeight();if(b.hide(),b.css("left",""),h+(a?s:0)>window.innerHeight&&(h=window.innerHeight-(a?s:0),b.css("height",h+"px")),b.css("top",""),b.css("left",""),b.css("transform",""),a&&l)b.css("transform","translate(0,0)"),b.css("top",s+"px"),b.css("left",r+"%"),b.css("width",i);else if(E.target){b.css("transform","translate(0,0)");var g=E.targetSide||"right",k=$(E.target);if(!k.length)throw new Error("Failed to locate target: "+E.target);var y=k.offset(),U=k.outerWidth(),H=k.outerHeight();"right"==g?e=y.left+U+E.targetOffset+p<window.innerWidth?y.left+U+E.targetOffset:window.innerWidth-p:"left"==g&&(e=y.left-E.targetOffset-p>0?y.left-E.targetOffset-p:0),"top"==E.targetVert?n=y.top:"middle"==E.targetVert?n=y.top-h/2+H/2:"bottom"==E.targetVert&&(n=y.top-h+H),0>n&&(n=0),n+h>window.innerHeight&&(n=window.innerHeight-h),b.css("top",n+"px"),b.css("left",e+"px")}else if(E.offsetTop&&E.offsetLeft){b.css("transform","translate(0,0)");var M=-1!=E.offsetTop.indexOf("%")?window.innerHeight*parseInt(E.offsetTop)/100:parseInt(E.offsetTop),T=-1!=E.offsetLeft.indexOf("%")?window.innerWidth*parseInt(E.offsetLeft)/100:parseInt(E.offsetLeft);n=M+h<window.innerHeight?E.offsetTop:window.innerHeight-h+"px",e=T+p<window.innerWidth?E.offsetLeft:window.innerWidth-p+"px",b.css("top",n),b.css("left",e)}else b.css("top",window.innerHeight/2-h/2+"px"),b.css("left",window.innerWidth/2-p/2+"px");x=$('<div tabindex="-1" class="dk-modal-backdrop"></div>'),E.backdropColor&&x.css("background-color",E.backdropColor),E.click&&x.click(v),E.key&&x.keyup(m),$("body").prepend(x),x.show(),c.addClass(x,"open"),b.show(),b.focus(),c.addClass(b,"open").then(function(){b.trigger("show")})}var b,x,y,U={},O=!1,E=angular.extend({},l,e(g));return U.hide=function(e){O&&(b.find(".exit-ok").off("click",u),b.find(".exit-cancel").off("click",w),b.off("keyup",m)),c.removeClass(x,"open").then(function(){x.remove()}),c.removeClass(b,"open").then(function(){var t="ok"==e?E.okEventName:E.cancelEventName;b.trigger(t),f.$broadcast(t),O?b.hide():b.remove()})},U.init=function(){function t(e,t){this["scope_"+t]=e}var o=h.defer(),n=o.promise,r=h.defer(),i=r.promise;if(!E.selector&&!E.template&&!E.templateUrl)throw new Error("Must set either selector or templateUrl");if(E.template){if(!E.scope)throw new Error("Scope is required with template option");b=s(E.template)(E.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for template")),o.resolve()}else if(E.templateUrl){if(!E.scope)throw new Error("scope is required with templateUrl option");if(E.scope.$regScope=t,"dkModalTemplate.html"==E.templateUrl){var l=E.scope.$new();l.close=E.defaultClose,l.header=E.scope.$eval(E.defaultHeader),l.body=E.scope.$eval(E.defaultBody),l.footer=E.defaultFooter,E.scope=l,window.testScope=l}var c;(c=d.get(E.templateUrl))?(b=s(c)(E.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for templateUrl: "+E.templateUrl)),o.resolve()):a.get(E.templateUrl).then(function(e){d.put(E.templateUrl,e.data),b=s(e.data)(E.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for templateUrl: "+E.templateUrl)),o.resolve()},function(e){o.reject(new Error("Failed to get modal for template: "+E.templateUrl))})}else E.selector&&(O=!0,b=$(E.selector),0===b.length&&o.reject(new Error("Failed to find modal from selector: "+E.selector)),o.resolve());return n.then(function(){angular.extend(E,e(b.data()),e(g)),y={modal:b,scope:E.scope},E.template||E.templateUrl?p(function(){r.resolve(y)}):r.resolve(y)},function(e){return r.reject(e)}),i},U.show=function(e){var t=h.defer(),o=t.promise;return e||!y?U.init().then(function(){k(),t.resolve(y)},function(e){t.reject(e)}):(k(),t.resolve(y)),o},U}}],a}),o.directive("dkModalTrigger",function(){return{restrict:"A",controller:["$scope","$element","$attrs","dkModal",function(t,o,n,r){o.click(function(){var i=e(o.data());if(i.templateUrl?i.scope=t:n.dkModalTrigger&&/.html$/i.test(n.dkModalTrigger)?(i.templateUrl=n.dkModalTrigger,i.scope=t):!i.selector&&n.dkModalTrigger&&(i.selector=n.dkModalTrigger),!i.templateUrl&&!i.selector)throw new Error("dkModal: Must supply either a templateUrl or selector");"this"==i.target&&(i.target=o),t.$apply(function(){r(i).show("init")})})}]}});var n='<div class="dk-modal"> <span class="dk-modal-close exit-cancel" ng-show="close">&times;</span> <div class="dk-modal-header" ng-show="header" ng-bind-html="header"></div> <div class="dk-modal-body" ng-bind-html="body"></div> <div class="dk-modal-footer" ng-show="footer"> <button class="btn btn-default exit-cancel dk-modal-button-no" ng-show="footer == \'yesno\'">No</button> <button class="btn btn-default exit-ok dk-modal-button-yes" ng-show="footer == \'yesno\'">Yes</button> <button class="btn btn-default exit-cancel dk-modal-button-cancel" ng-show="footer == \'okcancel\'">Cancel</button> <button class="btn btn-default exit-ok dk-modal-button-ok"                            ng-show="footer == \'okcancel\' || footer == \'ok\'">OK</button> </div> </div>';o.run(["$templateCache",function(e){e.put("dkModalTemplate.html",n)}])}();