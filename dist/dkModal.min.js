!function(){"use strict";function e(e){return $.each(e,function(t,o){"string"==typeof e[t]&&(e[t]=e[t].trim())}),["offsetTop","offSetLeft","width","height"].forEach(function(t,o){"number"==typeof e[t]&&(e[t]=e[t]+"px")}),"string"==typeof e.targetOffset&&-1!=e.targetOffset.indexOf("px")&&(e.targetOffset=parseFloat(e.targetOffset)),e}if(!$)throw new Error("dkModal depends on jquery");if(!angular)throw new Error("dkModal depends on angular");var t=angular.module("dkModal",["ngAnimate","ngTouch","ngSanitize"]);t.provider("$dkModal",function(){var t=767,o=27,n=2,r="96%",i={},a=-1!=window.navigator.userAgent.indexOf("Mobi"),l={selector:void 0,template:void 0,templateUrl:void 0,key:!0,click:!0,offsetTop:void 0,offsetLeft:void 0,target:void 0,targetVert:"middle",targetSide:"right",targetOffset:20,width:void 0,height:void 0,backdropColor:void 0,cancelEventName:"modalCancel",okEventName:"modalOk",defaultClose:!0,defaultHeader:void 0,defaultBody:"",defaultFooter:void 0};return i.setDefaults=function(t){angular.extend(l,e(t))},i.$get=["$http","$templateCache","$compile","$animate","$rootScope","$timeout","$q",function(i,d,s,c,f,p,h){return function(u){function g(e){return f.$apply(function(){U.hide("ok")}),!1}function w(e){return f.$apply(function(){U.hide("cancel")}),!1}function m(e){return e.which==o&&f.$apply(function(){U.hide("cancel")}),!1}function v(){return f.$apply(function(){U.hide("cancel")}),!1}function k(){var e,o,i,l;if(i=a&&window.innerWidth<=t,l=b.find("input, select, textarea").length>0,b.find(".exit-ok").click(g),b.find(".exit-cancel").click(w),b.addClass("dk-modal"),b.attr("tabindex","-1"),M.key&&b.on("keyup",m),M.width){var d=-1!=M.width.indexOf("%")?window.innerWidth*parseInt(M.width)/100:parseInt(M.width);d=d>window.innerWidth?window.innerWidth+"px":M.width,b.css("width",d)}else b.css("width","");var s=window.innerWidth*(n/100);if(M.height){var f=-1!=M.height.indexOf("%")?window.innerHeight*parseInt(M.height)/100:parseInt(M.height);f=i&&f+s>window.innerHeight?window.innerHeight-s+"px":f>window.innerHeight?window.innerHeight+"px":M.height,b.css("height",f)}else b.css("height","");b.css("left","-9999px"),b.show(),E||$(document.body).prepend(b);var p=b.outerWidth(),h=b.outerHeight();if(b.hide(),b.css("left",""),h+(i?s:0)>window.innerHeight&&(h=window.innerHeight-(i?s:0),b.css("height",h+"px")),b.css("top",""),b.css("left",""),b.css("transform",""),i&&l)b.css("transform","translate(0,0)"),b.css("top",s+"px"),b.css("left",n+"%"),b.css("width",r);else if(M.offsetTop&&M.offsetLeft){b.css("transform","translate(0,0)");var u=-1!=M.offsetTop.indexOf("%")?window.innerHeight*parseInt(M.offsetTop)/100:parseInt(M.offsetTop),k=-1!=M.offsetLeft.indexOf("%")?window.innerWidth*parseInt(M.offsetLeft)/100:parseInt(M.offsetLeft);o=u+h<window.innerHeight?M.offsetTop:window.innerHeight-h+"px",e=k+p<window.innerWidth?M.offsetLeft:window.innerWidth-p+"px",b.css("top",o),b.css("left",e)}else if(M.target){b.css("transform","translate(0,0)");var y=M.targetSide||"right",U=$(M.target);if(!U.length)throw new Error("Failed to locate target: "+M.target);var O=U.offset(),H=U.outerWidth(),T=U.outerHeight();"right"==y?e=O.left+H+M.targetOffset+p<window.innerWidth?O.left+H+M.targetOffset:window.innerWidth-p:"left"==y&&(e=O.left-M.targetOffset-p>0?O.left-M.targetOffset-p:0),"top"==M.targetVert?o=O.top:"middle"==M.targetVert?o=O.top-h/2+T/2:"bottom"==M.targetVert&&(o=O.top-h+T),0>o&&(o=0),o+h>window.innerHeight&&(o=window.innerHeight-h),b.css("top",o+"px"),b.css("left",e+"px")}x=$('<div tabindex="-1" class="dk-modal-backdrop"></div>'),M.backdropColor&&x.css("background-color",M.backdropColor),M.click&&x.click(v),M.key&&x.keyup(m),$("body").prepend(x),x.show(),c.addClass(x,"open"),b.show(),b.focus(),c.addClass(b,"open").then(function(){b.trigger("show")})}var b,x,y,U={},E=!1,M=angular.extend({},l,e(u));return U.hide=function(e){E&&(b.find(".exit-ok").off("click",g),b.find(".exit-cancel").off("click",w),b.off("keyup",m)),c.removeClass(x,"open").then(function(){x.remove()}),c.removeClass(b,"open").then(function(){var t="ok"==e?M.okEventName:M.cancelEventName;b.trigger(t),f.$broadcast(t),E?b.hide():b.remove()})},U.init=function(){function t(e,t){this["scope_"+t]=e}var o=h.defer(),n=o.promise,r=h.defer(),a=r.promise;if(!M.selector&&!M.template&&!M.templateUrl)throw new Error("Must set either selector or templateUrl");if(M.template){if(!M.scope)throw new Error("Scope is required with template option");b=s(M.template)(M.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for template")),o.resolve()}else if(M.templateUrl){if(!M.scope)throw new Error("scope is required with templateUrl option");if(M.scope.$regScope=t,"dkModalTemplate.html"==M.templateUrl){var l=M.scope.$new();l.close=M.defaultClose,l.header=M.scope.$eval(M.defaultHeader),l.body=M.scope.$eval(M.defaultBody),l.footer=M.defaultFooter,M.scope=l,window.testScope=l}var c;(c=d.get(M.templateUrl))?(b=s(c)(M.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for templateUrl: "+M.templateUrl)),o.resolve()):i.get(M.templateUrl).then(function(e){d.put(e.data),b=s(e.data)(M.scope),b&&0!==b.length||o.reject(new Error("Failed to get compile modal for templateUrl: "+M.templateUrl)),o.resolve()},function(e){o.reject(new Error("Failed to get modal for template: "+M.templateUrl))})}else M.selector&&(E=!0,b=$(M.selector),0===b.length&&o.reject(new Error("Failed to find modal from selector: "+M.selector)),o.resolve());return n.then(function(){angular.extend(M,e(b.data()),e(u)),y={modal:b,scope:M.scope&&M.scope.$modalChild||M.scope},M.template||M.templateUrl?p(function(){r.resolve(y)}):r.resolve(y)},function(e){return r.reject(e)}),a},U.show=function(e){var t=h.defer(),o=t.promise;return e||!y?U.init().then(function(){k(),t.resolve(y)},function(e){t.reject(e)}):(k(),t.resolve(y)),o},U}}],i}),t.directive("dkModalTrigger",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$dkModal",function(t,o,n,r){o.click(function(){var i=e(o.data());if(i.templateUrl?i.scope=t:n.dkModalTrigger&&/.html$/i.test(n.dkModalTrigger)?(i.templateUrl=n.dkModalTrigger,i.scope=t):!i.selector&&n.dkModalTrigger&&(i.selector=n.dkModalTrigger),!i.templateUrl&&!i.selector)throw new Error("dkModal: Must supply either a templateUrl or selector");"this"==i.target&&(i.target=o),t.$apply(function(){r(i).show("init")})})}]}});var o='<div class="dk-modal"> <span class="dk-modal-close exit-cancel" ng-show="close">&times;</span> <div class="dk-modal-header" ng-show="header" ng-bind-html="header"></div> <div class="dk-modal-body" ng-bind-html="body"></div> <div class="dk-modal-footer" ng-show="footer"> <button class="btn btn-default exit-cancel dk-modal-button-no" ng-show="footer == \'yesno\'">No</button> <button class="btn btn-default exit-ok dk-modal-button-yes" ng-show="footer == \'yesno\'">Yes</button> <button class="btn btn-default exit-cancel dk-modal-button-cancel" ng-show="footer == \'okcancel\'">Cancel</button> <button class="btn btn-default exit-ok dk-modal-button-ok"                            ng-show="footer == \'okcancel\' || footer == \'ok\'">OK</button> </div> </div>';t.run(["$templateCache",function(e){e.put("dkModalTemplate.html",o)}])}();